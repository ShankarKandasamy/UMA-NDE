<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <defs>
    <style>
      .pipe { stroke: #2c5530; stroke-width: 6; fill: none; }
      .pipe-centerline { stroke: #2c5530; stroke-width: 1; stroke-dasharray: 10,5; fill: none; }
      .cml-normal { fill: #4a90d9; stroke: #1a4a7a; stroke-width: 1; }
      .cml-critical { fill: #e53935; stroke: #b71c1c; stroke-width: 2; }
      .cml-alert { fill: #ff9800; stroke: #e65100; stroke-width: 1; }
      
      /* FIX: Added Halo effect and paint-order to ensure text is never obscured by lines */
      .cml-label { 
        font-family: Arial, sans-serif; font-size: 10px; font-weight: bold; fill: #333; 
        paint-order: stroke; stroke: #ffffff; stroke-width: 3px; stroke-linecap: round; stroke-linejoin: round; 
      }
      .cml-reading { 
        font-family: Arial, sans-serif; font-size: 9px; fill: #444; 
        paint-order: stroke; stroke: #ffffff; stroke-width: 2.5px; stroke-linecap: round; stroke-linejoin: round; 
      }
      
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #1a3a5c; }
      .subtitle { font-family: Arial, sans-serif; font-size: 11px; fill: #4a5568; }
      .label { font-family: Arial, sans-serif; font-size: 10px; fill: #333; }
      .dimension { font-family: Arial, sans-serif; font-size: 8px; fill: #666; }
      .equipment { fill: #e0e0e0; stroke: #666; stroke-width: 1; }
      .equipment-label { font-family: Arial, sans-serif; font-size: 10px; fill: #333; font-weight: bold; }
      .north-arrow { fill: #333; }
      .legend-box { fill: white; stroke: #ccc; stroke-width: 1; }
    </style>
    
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c5530"/>
    </marker>
  </defs>
  
  <rect x="10" y="10" width="780" height="50" fill="#f5f5f5" stroke="#ccc"/>
  <text x="20" y="35" class="title">PIPING ISOMETRIC - LINE 4-RA-101</text>
  <text x="20" y="50" class="subtitle">Rich Amine | 4" A106 Gr.B Sch 80 | ATU-100 Amine Treating Unit</text>
  <text x="580" y="30" class="label">Drawing: GLCP-ISO-ATU-4RA101</text>
  <text x="580" y="45" class="label">Rev: 0 | Date: Oct 2024</text>
  
  <g transform="translate(740, 80)">
    <polygon points="0,-20 -8,10 0,5 8,10" class="north-arrow"/>
    <text x="0" y="25" text-anchor="middle" class="label">N</text>
  </g>
  
  <g transform="translate(100, 180)">
    <rect x="-30" y="-60" width="60" height="120" rx="5" class="equipment"/>
    <text x="0" y="80" text-anchor="middle" class="equipment-label">V-101</text>
    <text x="0" y="95" text-anchor="middle" class="dimension">Contactor</text>
  </g>
  
  <g transform="translate(550, 350)">
    <ellipse cx="0" cy="0" rx="50" ry="25" class="equipment"/>
    <text x="0" y="5" text-anchor="middle" class="equipment-label">E-103</text>
    <text x="0" y="45" text-anchor="middle" class="dimension">L/R Exchanger</text>
  </g>
  
  <line x1="130" y1="180" x2="130" y2="280" class="pipe"/>
  <path d="M 130 280 Q 130 310 160 310" class="pipe"/>
  <line x1="160" y1="310" x2="280" y2="310" class="pipe" marker-end="url(#arrow)"/>
  <path d="M 280 310 Q 310 310 310 340" class="pipe"/>
  <line x1="310" y1="340" x2="400" y2="380" class="pipe"/>
  <path d="M 400 380 Q 415 390 430 380" class="pipe"/>
  <line x1="430" y1="380" x2="500" y2="350" class="pipe" marker-end="url(#arrow)"/>
  
  <circle cx="130" cy="200" r="6" class="cml-normal"/>
  <circle cx="130" cy="230" r="6" class="cml-normal"/>
  <circle cx="130" cy="260" r="6" class="cml-normal"/>
  <circle cx="145" cy="295" r="6" class="cml-normal"/>
  <circle cx="200" cy="310" r="6" class="cml-normal"/>
  <circle cx="245" cy="310" r="8" class="cml-critical"/>
  <circle cx="295" cy="325" r="6" class="cml-normal"/>
  <circle cx="340" cy="355" r="6" class="cml-normal"/>
  <circle cx="370" cy="370" r="6" class="cml-normal"/>
  <circle cx="410" cy="380" r="6" class="cml-normal"/>
  <circle cx="460" cy="365" r="6" class="cml-normal"/>
  <circle cx="490" cy="355" r="6" class="cml-normal"/>

  <g id="labels-overlay">
    <text x="145" y="198" class="cml-label">01</text>
    <text x="145" y="210" class="cml-reading">0.187"</text>
    <text x="145" y="228" class="cml-label">02</text>
    <text x="145" y="240" class="cml-reading">0.212"</text>
    <text x="145" y="258" class="cml-label">03</text>
    <text x="145" y="270" class="cml-reading">0.232"</text>
    <text x="160" y="293" class="cml-label">04</text>
    <text x="160" y="305" class="cml-reading">0.23"</text>
    <text x="215" y="300" class="cml-label">05</text>
    <text x="215" y="312" class="cml-reading">0.237"</text>
    <text x="260" y="295" class="cml-label">06</text>
    <text x="260" y="307" class="cml-reading">0.142"</text>
    <text x="310" y="325" class="cml-label">07</text>
    <text x="310" y="337" class="cml-reading">0.186"</text>
    <text x="355" y="350" class="cml-label">08</text>
    <text x="355" y="362" class="cml-reading">0.235"</text>
    <text x="385" y="365" class="cml-label">09</text>
    <text x="385" y="377" class="cml-reading">0.194"</text>
    <text x="425" y="375" class="cml-label">10</text>
    <text x="425" y="387" class="cml-reading">0.255"</text>
    <text x="475" y="360" class="cml-label">11</text>
    <text x="475" y="372" class="cml-reading">0.221"</text>
    <text x="505" y="350" class="cml-label">12</text>
    <text x="505" y="362" class="cml-reading">0.255"</text>
  </g>

  <rect x="580" y="450" width="200" height="120" class="legend-box"/>
  <text x="590" y="470" class="label" font-weight="bold">LEGEND</text>
  <circle cx="600" cy="490" r="6" class="cml-normal"/>
  <text x="615" y="494" class="label">CML - Acceptable</text>
  <circle cx="600" cy="510" r="7" class="cml-alert"/>
  <text x="615" y="514" class="label">CML - Alert (near t-min)</text>
  <circle cx="600" cy="530" r="8" class="cml-critical"/>
  <text x="615" y="534" class="label">CML - CRITICAL (below t-min)</text>
  <line x1="590" y1="550" x2="610" y2="550" class="pipe"/>
  <text x="615" y="554" class="label">4" Pipe (Sch 80)</text>
  
  <text x="20" y="520" class="dimension">Notes:</text>
  <text x="20" y="535" class="dimension">1. All dimensions in inches</text>
  <text x="20" y="550" class="dimension">2. CML numbers shown as last two digits (e.g., "06" = 4-RA-101-06)</text>
  <text x="20" y="565" class="dimension">3. Readings shown are from Nov 2024 survey</text>
  <text x="20" y="580" class="dimension">4. t-min = 0.150" per ASME B31.3</text>
</svg>
